!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("FaviconCountBase",[],t):"object"==typeof exports?exports.FaviconCountBase=t():e.FaviconCountBase=t()}(this,(function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function a(e,t,n){const a=[],o=e<t,r=n?o?t+1:t-1:t;for(let t=e;o?t<r:t>r;o?t++:t--)a.push(t);return a}n.r(t);const o={0:[[0,0,1,1,1,1,0,0],[0,1,0,0,0,0,1,0],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[0,1,0,0,0,0,1,0],[0,0,1,1,1,1,0,0]],1:[[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,1,1,1,0,0,0],[0,1,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,1,1,1,1,1,1,1]],2:[[0,1,1,1,1,0,0,0],[1,0,0,0,0,1,0,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,0,0],[0,0,0,0,1,0,0,0],[0,0,0,1,0,0,0,0],[0,0,1,0,0,0,0,0],[0,1,0,0,0,0,0,0],[1,1,1,1,1,1,1,1]],3:[[0,1,1,1,1,1,0,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0],[0,0,0,1,1,1,0,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0],[0,1,1,1,1,1,0,0]],4:[[0,0,0,0,0,1,0,0],[0,0,0,0,1,1,0,0],[0,0,0,1,0,1,0,0],[0,0,1,0,0,1,0,0],[0,1,0,0,0,1,0,0],[1,0,0,0,0,1,0,0],[1,0,0,0,0,1,0,0],[1,1,1,1,1,1,1,1],[0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0]],5:[[0,1,1,1,1,1,1,1],[0,1,0,0,0,0,0,0],[0,1,0,0,0,0,0,0],[0,1,0,0,0,0,0,0],[0,1,0,0,0,0,0,0],[0,1,1,1,1,1,0,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1],[1,0,0,0,0,0,1,0],[0,1,1,1,1,1,0,0]],6:[[0,0,0,1,1,1,1,0],[0,0,1,0,0,0,0,0],[0,1,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[1,0,1,1,1,1,0,0],[1,1,0,0,0,0,1,0],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[0,1,0,0,0,0,1,0],[0,0,1,1,1,1,0,0]],7:[[1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,0,0],[0,0,0,0,0,1,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,1,0,0,0,0],[0,0,0,1,0,0,0,0],[0,0,1,0,0,0,0,0],[0,0,1,0,0,0,0,0],[0,1,0,0,0,0,0,0],[0,1,0,0,0,0,0,0]],8:[[0,0,1,1,1,1,0,0],[0,1,0,0,0,0,1,0],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[0,1,0,0,0,0,1,0],[0,0,1,1,1,1,0,0],[0,1,0,0,0,0,1,0],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[0,1,0,0,0,0,1,0],[0,0,1,1,1,1,0,0]],9:[[0,0,1,1,1,1,0,0],[0,1,0,0,0,0,1,0],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,1],[0,1,0,0,0,0,1,1],[0,0,1,1,1,1,0,1],[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0],[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,0,0],[0,1,1,1,1,0,0,0]],"+":[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,1,1,1,1,1,1,1],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]};t.default=class{constructor(){const e=this.getFavicon();e&&(this.faviconImage=e.getAttribute("href"),[this.head]=document.getElementsByTagName("head"))}render(e){null!=e?this.drawCountOnCanvas(e,e=>{this.addIconToDom(e.toDataURL("image/png"))}):this.getFaviconCanvas(e=>{this.addIconToDom(e.toDataURL("image/png"))})}getFavicon(){var e;return(e=document.getElementsByTagName("link"),[].slice.call(e)).filter(e=>e.getAttribute("rel").includes("icon")).sort((e,t)=>{const n=e.getAttribute("sizes")?parseInt(e.getAttribute("sizes").split("x")[0],10):0,a=t.getAttribute("sizes")?parseInt(t.getAttribute("sizes").split("x")[0],10):0;return 32===n?-1:32===a?1:a-n})[0]}getFaviconCanvas(e){if(this.faviconCanvas)e(this.faviconCanvas);else{this.faviconCanvas=document.createElement("canvas"),this.faviconCanvas.width=32,this.faviconCanvas.height=32;const t=this.faviconCanvas.getContext("2d"),n=new Image;n.crossOrigin="anonymous",n.addEventListener("load",()=>{t.drawImage(n,0,0,32,32),e(this.faviconCanvas)},!0),n.src=this.faviconImage}}drawCountOnCanvas(e,t){const n=e>99?"99+":e;if(this.drawnCanvases||(this.drawnCanvases={}),this.drawnCanvases[n])return void t(this.drawnCanvases[n]);const a=String(n).length;this.getFaviconCanvas(e=>{const r=document.createElement("canvas");r.height=e.width,r.width=e.width;const i=r.getContext("2d");i.drawImage(e,0,0),console.log(window.matchMedia("(prefers-color-scheme: dark)")),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?(i.strokeStyle="rgba(0, 0, 0, 0.6)",i.fillStyle="#FFF"):(i.strokeStyle="rgba(255, 255, 255, 0.6)",i.fillStyle="#000");const s=.0625*e.width,c=e.height-o[0].length-s,d=o[0][0].length*a+2*(a-1);let l=e.width-d-1;l<0&&(l=0),this.drawCharacters({characters:n,fn:(e,t)=>{i.strokeRect(e+l-2,t+c-2,6,6)}}),this.drawCharacters({characters:n,fn:(e,t)=>{i.fillRect(e+l,t+c,2,2)}}),this.drawnCanvases[n]=r,t(r)})}drawCharacters({characters:e,fn:t}){let n,r,i,s,c=0;a(0,String(e).length).forEach((d,l)=>{n=String(e)[l],o[n]&&(r=o[n],i=r.length,s=r[0].length,c=s*l+2*l,a(0,i).forEach(e=>{a(0,s).forEach(n=>{r[e][n]&&t(n+c,e)})}))})}addIconToDom(e){const t=this.head.getElementsByTagName("link");[].slice.call(t).forEach(e=>{"shortcut icon"!==e.rel&&"icon"!==e.rel||this.head.removeChild(e)});const n=document.createElement("link");n.type="image/png",n.rel="shortcut icon",n.href=e,this.head.appendChild(n);const a=document.createElement("iframe");a.width=0,a.height=0,document.body.appendChild(a),a.src="icon",document.body.removeChild(a)}}}])}));